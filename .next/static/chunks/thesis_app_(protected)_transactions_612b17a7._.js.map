{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/transactions/lib/useBudgetData.js"],"sourcesContent":["\"use client\"\r\nimport { useState } from \"react\"\r\nimport { supabase } from \"../../../lib/supabaseClient\"\r\n\r\nexport default function useBudgetData() {\r\n  const [budgetData, setBudgetData] = useState([])\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  async function fetchBudgetData() {\r\n    setLoading(true)\r\n\r\n    const { data, error } = await supabase\r\n      .from(\"yearly_budget\")\r\n      .select(\"year,total_income\")\r\n      .order(\"year\", { ascending: true })\r\n\r\n    setLoading(false)\r\n    if (error) return console.error(error)\r\n\r\n    setBudgetData(\r\n      data.map(d => ({\r\n        year: Number(d.year),\r\n        totalIncome: Number(d.total_income)\r\n      }))\r\n    )\r\n  }\r\n\r\n  return { budgetData, loading, fetchBudgetData }\r\n}\r\n"],"names":[],"mappings":";;;;AACA;;;;;;;AADA;;;AAIe,SAAS;;IACtB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,mLAAQ,EAAC,EAAE;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,mLAAQ,EAAC;IAEvC,eAAe;QACb,WAAW;QAEX,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,iBACL,MAAM,CAAC,qBACP,KAAK,CAAC,QAAQ;YAAE,WAAW;QAAK;QAEnC,WAAW;QACX,IAAI,OAAO,OAAO,QAAQ,KAAK,CAAC;QAEhC,cACE,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;gBACb,MAAM,OAAO,EAAE,IAAI;gBACnB,aAAa,OAAO,EAAE,YAAY;YACpC,CAAC;IAEL;IAEA,OAAO;QAAE;QAAY;QAAS;IAAgB;AAChD;GAxBwB","debugId":null}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/transactions/lib/useBreakdownData.js"],"sourcesContent":["\"use client\"\r\nimport { useState } from \"react\"\r\nimport { supabase } from \"../../../lib/supabaseClient\"\r\n\r\nexport default function useBreakdownData() {\r\n  const [breakdownData, setBreakdownData] = useState({})\r\n\r\n  async function fetchBreakdownData() {\r\n    const { data, error } = await supabase\r\n      .from(\"barangay_budget_breakdown\")\r\n      .select(\"year, category, subcategory, description, amount\")\r\n\r\n    if (error) return console.error(error)\r\n\r\n    const grouped = {}\r\n\r\n    data.forEach(row => {\r\n      const year = Number(row.year)\r\n      if (!grouped[year]) grouped[year] = { income: {}, appropriations: {} }\r\n\r\n      const cat = row.category?.toLowerCase().includes(\"income\")\r\n        ? \"income\"\r\n        : \"appropriations\"\r\n\r\n      const label = row.subcategory || row.description || \"Uncategorized\"\r\n      const value = Number(String(row.amount).replace(/[^\\d.-]/g, \"\"))\r\n\r\n      grouped[year][cat][label] =\r\n        (grouped[year][cat][label] || 0) + value\r\n    })\r\n\r\n    setBreakdownData(grouped)\r\n  }\r\n\r\n  return { breakdownData, fetchBreakdownData }\r\n}\r\n"],"names":[],"mappings":";;;;AACA;;;;;;;AADA;;;AAIe,SAAS;;IACtB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,mLAAQ,EAAC,CAAC;IAEpD,eAAe;QACb,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,6BACL,MAAM,CAAC;QAEV,IAAI,OAAO,OAAO,QAAQ,KAAK,CAAC;QAEhC,MAAM,UAAU,CAAC;QAEjB,KAAK,OAAO,CAAC,CAAA;gBAIC;YAHZ,MAAM,OAAO,OAAO,IAAI,IAAI;YAC5B,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,KAAK,GAAG;gBAAE,QAAQ,CAAC;gBAAG,gBAAgB,CAAC;YAAE;YAErE,MAAM,MAAM,EAAA,gBAAA,IAAI,QAAQ,cAAZ,oCAAA,cAAc,WAAW,GAAG,QAAQ,CAAC,aAC7C,WACA;YAEJ,MAAM,QAAQ,IAAI,WAAW,IAAI,IAAI,WAAW,IAAI;YACpD,MAAM,QAAQ,OAAO,OAAO,IAAI,MAAM,EAAE,OAAO,CAAC,YAAY;YAE5D,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,GACvB,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI;QACvC;QAEA,iBAAiB;IACnB;IAEA,OAAO;QAAE;QAAe;IAAmB;AAC7C;GA/BwB","debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/transactions/page.jsx"],"sourcesContent":["\"use client\"\r\nimport { useState, useEffect } from \"react\"\r\nimport { supabase } from \"../../lib/supabaseClient\"\r\n\r\n// Hooks\r\nimport useBudgetData from \"./lib/useBudgetData\"\r\nimport useBreakdownData from \"./lib/useBreakdownData\"\r\n\r\n// Components\r\nimport BudgetUploader from \"./components/BudgetUploader\"\r\nimport SummaryCards from \"./components/SummaryCards\"\r\nimport IncomeTrendChart from \"./components/IncomeTrendChart\"\r\nimport BreakdownPieSection from \"./components/BreakdownPieSection\"\r\n\r\nexport default function TransactionPage() {\r\n  const [session, setSession] = useState(null)\r\n  const [selectedYear, setSelectedYear] = useState(null)\r\n\r\n  // Custom hooks\r\n  const { budgetData, loading, fetchBudgetData } = useBudgetData()\r\n  const { breakdownData, fetchBreakdownData } = useBreakdownData()\r\n\r\n  // Check auth\r\n  useEffect(() => {\r\n    supabase.auth.getSession().then(({ data: { session } }) => {\r\n      setSession(session)\r\n      if (session) {\r\n        fetchBudgetData()\r\n        fetchBreakdownData()\r\n      }\r\n    })\r\n\r\n    const { data: listener } = supabase.auth.onAuthStateChange((_event, session) => {\r\n      setSession(session)\r\n      if (session) {\r\n        fetchBudgetData()\r\n        fetchBreakdownData()\r\n      }\r\n    })\r\n\r\n    return () => listener.subscription.unsubscribe()\r\n  }, [])\r\n\r\n  if (!session) return <div className=\"p-10 text-center\">Please log in first</div>\r\n  if (loading) return <p className=\"p-6\">Loading budget data...</p>\r\n\r\n  const selectedData = breakdownData[selectedYear] || {}\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-8\">\r\n      <h2 className=\"text-2xl font-semibold\">Barangay Budget Dashboard</h2>\r\n\r\n      <BudgetUploader refresh={fetchBudgetData} />\r\n\r\n      <SummaryCards data={budgetData} />\r\n\r\n      <IncomeTrendChart\r\n        data={budgetData}\r\n        onYearClick={setSelectedYear}\r\n      />\r\n\r\n      <BreakdownPieSection\r\n        selectedYear={selectedYear}\r\n        breakdown={selectedData}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;;;;;;AAGA,QAAQ;AACR;AACA;;;;;;;;;;;;;;;;;;;;;;;AANA;;;;;;;;;AAce,SAAS;;IACtB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,mLAAQ,EAAC;IACvC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,mLAAQ,EAAC;IAEjD,eAAe;IACf,MAAM,EAAE,UAAU,EAAE,OAAO,EAAE,eAAe,EAAE,GAAG,IAAA,oLAAa;IAC9D,MAAM,EAAE,aAAa,EAAE,kBAAkB,EAAE,GAAG,IAAA,uLAAgB;IAE9D,aAAa;IACb,IAAA,oLAAS;qCAAC;YACR,SAAS,IAAI,CAAC,UAAU,GAAG,IAAI;6CAAC;wBAAC,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE;oBACpD,WAAW;oBACX,IAAI,SAAS;wBACX;wBACA;oBACF;gBACF;;YAEA,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,SAAS,IAAI,CAAC,iBAAiB;6CAAC,CAAC,QAAQ;oBAClE,WAAW;oBACX,IAAI,SAAS;wBACX;wBACA;oBACF;gBACF;;YAEA;6CAAO,IAAM,SAAS,YAAY,CAAC,WAAW;;QAChD;oCAAG,EAAE;IAEL,IAAI,CAAC,SAAS,qBAAO,uMAAC;QAAI,WAAU;kBAAmB;;;;;;IACvD,IAAI,SAAS,qBAAO,uMAAC;QAAE,WAAU;kBAAM;;;;;;IAEvC,MAAM,eAAe,aAAa,CAAC,aAAa,IAAI,CAAC;IAErD,qBACE,uMAAC;QAAI,WAAU;;0BACb,uMAAC;gBAAG,WAAU;0BAAyB;;;;;;0BAEvC,uMAAC;gBAAe,SAAS;;;;;;0BAEzB,uMAAC;gBAAa,MAAM;;;;;;0BAEpB,uMAAC;gBACC,MAAM;gBACN,aAAa;;;;;;0BAGf,uMAAC;gBACC,cAAc;gBACd,WAAW;;;;;;;;;;;;AAInB;GArDwB;;QAK2B,oLAAa;QAChB,uLAAgB;;;KANxC","debugId":null}}]
}