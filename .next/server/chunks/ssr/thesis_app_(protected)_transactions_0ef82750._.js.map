{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/transactions/lib/useBudgetData.js"],"sourcesContent":["\"use client\"\r\nimport { useState } from \"react\"\r\nimport { supabase } from \"../../../../lib/supabaseClient\"\r\n\r\nexport default function useBudgetData() {\r\n  const [budgetData, setBudgetData] = useState([])\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  async function fetchBudgetData() {\r\n    setLoading(true)\r\n\r\n    const { data, error } = await supabase\r\n      .from(\"yearly_budget\")\r\n      .select(\"year,total_income\")\r\n      .order(\"year\", { ascending: true })\r\n\r\n    setLoading(false)\r\n    if (error) return console.error(error)\r\n\r\n    setBudgetData(\r\n      data.map(d => ({\r\n        year: Number(d.year),\r\n        totalIncome: Number(d.total_income)\r\n      }))\r\n    )\r\n  }\r\n\r\n  return { budgetData, loading, fetchBudgetData }\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;AAIe,SAAS;IACtB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,2NAAQ,EAAC,EAAE;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,2NAAQ,EAAC;IAEvC,eAAe;QACb,WAAW;QAEX,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,2IAAQ,CACnC,IAAI,CAAC,iBACL,MAAM,CAAC,qBACP,KAAK,CAAC,QAAQ;YAAE,WAAW;QAAK;QAEnC,WAAW;QACX,IAAI,OAAO,OAAO,QAAQ,KAAK,CAAC;QAEhC,cACE,KAAK,GAAG,CAAC,CAAA,IAAK,CAAC;gBACb,MAAM,OAAO,EAAE,IAAI;gBACnB,aAAa,OAAO,EAAE,YAAY;YACpC,CAAC;IAEL;IAEA,OAAO;QAAE;QAAY;QAAS;IAAgB;AAChD","debugId":null}},
    {"offset": {"line": 38, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/transactions/lib/useBreakdownData.js"],"sourcesContent":["\"use client\"\r\nimport { useState } from \"react\"\r\nimport { supabase } from \"../../../../lib/supabaseClient\"\r\n\r\nexport default function useBreakdownData() {\r\n  const [breakdownData, setBreakdownData] = useState({})\r\n\r\n  async function fetchBreakdownData() {\r\n    const { data, error } = await supabase\r\n      .from(\"barangay_budget_breakdown\")\r\n      .select(\"year, category, subcategory, description, amount\")\r\n\r\n    if (error) return console.error(error)\r\n\r\n    const grouped = {}\r\n\r\n    data.forEach(row => {\r\n      const year = Number(row.year)\r\n      if (!grouped[year]) grouped[year] = { income: {}, appropriations: {} }\r\n\r\n      const cat = row.category?.toLowerCase().includes(\"income\")\r\n        ? \"income\"\r\n        : \"appropriations\"\r\n\r\n      const label = row.subcategory || row.description || \"Uncategorized\"\r\n      const value = Number(String(row.amount).replace(/[^\\d.-]/g, \"\"))\r\n\r\n      grouped[year][cat][label] =\r\n        (grouped[year][cat][label] || 0) + value\r\n    })\r\n\r\n    setBreakdownData(grouped)\r\n  }\r\n\r\n  return { breakdownData, fetchBreakdownData }\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;AAIe,SAAS;IACtB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,2NAAQ,EAAC,CAAC;IAEpD,eAAe;QACb,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,2IAAQ,CACnC,IAAI,CAAC,6BACL,MAAM,CAAC;QAEV,IAAI,OAAO,OAAO,QAAQ,KAAK,CAAC;QAEhC,MAAM,UAAU,CAAC;QAEjB,KAAK,OAAO,CAAC,CAAA;YACX,MAAM,OAAO,OAAO,IAAI,IAAI;YAC5B,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,KAAK,GAAG;gBAAE,QAAQ,CAAC;gBAAG,gBAAgB,CAAC;YAAE;YAErE,MAAM,MAAM,IAAI,QAAQ,EAAE,cAAc,SAAS,YAC7C,WACA;YAEJ,MAAM,QAAQ,IAAI,WAAW,IAAI,IAAI,WAAW,IAAI;YACpD,MAAM,QAAQ,OAAO,OAAO,IAAI,MAAM,EAAE,OAAO,CAAC,YAAY;YAE5D,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,GACvB,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI;QACvC;QAEA,iBAAiB;IACnB;IAEA,OAAO;QAAE;QAAe;IAAmB;AAC7C","debugId":null}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/transactions/components/summaryCards.jsx"],"sourcesContent":["export default function SummaryCards({ data }) {\r\n  const total = data.reduce((s, d) => s + d.totalIncome, 0)\r\n  const avg = total / data.length\r\n  const max = Math.max(...data.map(d => d.totalIncome))\r\n  const min = Math.min(...data.map(d => d.totalIncome))\r\n\r\n  const currency = val =>\r\n    new Intl.NumberFormat(\"en-PH\", { style: \"currency\", currency: \"PHP\" }).format(val)\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n      <Card label=\"Total Budget\" value={currency(total)} color=\"indigo\" />\r\n      <Card label=\"Average Budget\" value={currency(avg)} color=\"green\" />\r\n      <Card label=\"Highest Budget\" value={currency(max)} color=\"yellow\" />\r\n      <Card label=\"Lowest Budget\" value={currency(min)} color=\"red\" />\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction Card({ label, value, color }) {\r\n  const colors = {\r\n    indigo: \"bg-indigo-50 text-indigo-700\",\r\n    green: \"bg-green-50 text-green-700\",\r\n    yellow: \"bg-yellow-50 text-yellow-700\",\r\n    red: \"bg-red-50 text-red-700\",\r\n  }\r\n\r\n  return (\r\n    <div className={`p-4 rounded-lg text-center ${colors[color]}`}>\r\n      <p className=\"text-sm text-gray-600\">{label}</p>\r\n      <p className=\"text-lg font-semibold\">{value}</p>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAe,SAAS,aAAa,EAAE,IAAI,EAAE;IAC3C,MAAM,QAAQ,KAAK,MAAM,CAAC,CAAC,GAAG,IAAM,IAAI,EAAE,WAAW,EAAE;IACvD,MAAM,MAAM,QAAQ,KAAK,MAAM;IAC/B,MAAM,MAAM,KAAK,GAAG,IAAI,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,WAAW;IACnD,MAAM,MAAM,KAAK,GAAG,IAAI,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,WAAW;IAEnD,MAAM,WAAW,CAAA,MACf,IAAI,KAAK,YAAY,CAAC,SAAS;YAAE,OAAO;YAAY,UAAU;QAAM,GAAG,MAAM,CAAC;IAEhF,qBACE,wPAAC;QAAI,WAAU;;0BACb,wPAAC;gBAAK,OAAM;gBAAe,OAAO,SAAS;gBAAQ,OAAM;;;;;;0BACzD,wPAAC;gBAAK,OAAM;gBAAiB,OAAO,SAAS;gBAAM,OAAM;;;;;;0BACzD,wPAAC;gBAAK,OAAM;gBAAiB,OAAO,SAAS;gBAAM,OAAM;;;;;;0BACzD,wPAAC;gBAAK,OAAM;gBAAgB,OAAO,SAAS;gBAAM,OAAM;;;;;;;;;;;;AAG9D;AAEA,SAAS,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE;IACnC,MAAM,SAAS;QACb,QAAQ;QACR,OAAO;QACP,QAAQ;QACR,KAAK;IACP;IAEA,qBACE,wPAAC;QAAI,WAAW,CAAC,2BAA2B,EAAE,MAAM,CAAC,MAAM,EAAE;;0BAC3D,wPAAC;gBAAE,WAAU;0BAAyB;;;;;;0BACtC,wPAAC;gBAAE,WAAU;0BAAyB;;;;;;;;;;;;AAG5C","debugId":null}},
    {"offset": {"line": 173, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/transactions/components/forecastChart.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  Tooltip,\r\n  CartesianGrid,\r\n  ResponsiveContainer,\r\n  Legend,\r\n  ReferenceLine,\r\n} from \"recharts\";\r\n\r\nexport default function ForecastChart({ historyData, forecastData }) {\r\n\r\n  // ---------- ACTUAL DATA ----------\r\n  const actualData = Array.isArray(historyData)\r\n    ? historyData.map(d => ({\r\n        year: Number(d.year),\r\n        actual: d.totalIncome ?? 0,\r\n        forecast: null,\r\n      }))\r\n    : [];\r\n\r\n  const lastActualYear =\r\n    actualData.length > 0\r\n      ? Math.max(...actualData.map(d => d.year))\r\n      : null;\r\n\r\n  // ---------- FORECAST DATA ----------\r\n  const forecastMapped = Array.isArray(forecastData)\r\n    ? forecastData\r\n        .filter(f => f.year > lastActualYear) // âœ… starts AFTER actual\r\n        .map(f => ({\r\n          year: Number(f.year),\r\n          actual: null,\r\n          forecast: f.value ?? 0,\r\n        }))\r\n    : [];\r\n\r\n  const combinedData = [\r\n    ...actualData,\r\n    ...forecastMapped,\r\n  ];\r\n\r\n  const forecastStartYear = forecastMapped?.[0]?.year;\r\n\r\n  return (\r\n    <div className=\"bg-white shadow rounded-lg overflow-hidden\">\r\n      <ResponsiveContainer width=\"100%\" height={400}>\r\n        <LineChart\r\n          data={combinedData}\r\n          margin={{ top: 20, right: 10, left: 10, }}\r\n        >\r\n          <CartesianGrid strokeDasharray=\"3 3\" />\r\n\r\n          {/* X AXIS â€“ FIXED */}\r\n          <XAxis\r\n            dataKey=\"year\"\r\n            type=\"number\"\r\n            allowDecimals={false}\r\n            domain={[\"dataMin\", \"dataMax\"]}\r\n            tick={{ fontSize: 13 }}\r\n          />\r\n\r\n          <YAxis\r\n            tickFormatter={(v) => `â‚±${(v / 1_000_000).toFixed(1)}M`}\r\n            tick={{ fontSize: 15 }}\r\n          />\r\n\r\n          <Tooltip\r\n            labelFormatter={(v) => `Year ${v}`}\r\n            formatter={(v, name) => [\r\n              `â‚±${Number(v).toLocaleString()}`,\r\n              name === \"actual\" ? \"Actual Budget\" : \"Forecasted Budget\",\r\n            ]}\r\n          />\r\n\r\n          <Legend verticalAlign=\"bottom\" height={30} />\r\n\r\n          {/* FORECAST START LINE */}\r\n          {forecastStartYear && (\r\n            <ReferenceLine\r\n              x={forecastStartYear}\r\n              stroke=\"#10B981\"\r\n              strokeDasharray=\"4 4\"\r\n              label={{\r\n                value: \"Forecast Starts\",\r\n                position: \"top\",\r\n                fill: \"#10B981\",\r\n                fontSize: 18,\r\n              }}\r\n            />\r\n          )}\r\n\r\n          {/* ACTUAL */}\r\n          <Line\r\n            type=\"monotone\"\r\n            dataKey=\"actual\"\r\n            name=\"Actual Budget\"\r\n            stroke=\"#4F46E5\"\r\n            strokeWidth={3}\r\n            dot={{ r: 4 }}\r\n            isAnimationActive={false}\r\n          />\r\n\r\n          {/* FORECAST */}\r\n          <Line\r\n            type=\"monotone\"\r\n            dataKey=\"forecast\"\r\n            name=\"Forecasted Budget\"\r\n            stroke=\"#10B981\"\r\n            strokeDasharray=\"6 6\"\r\n            strokeWidth={3}\r\n            dot={{ r: 4 }}\r\n            isAnimationActive={false}\r\n          />\r\n        </LineChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;;;AAce,SAAS,cAAc,EAAE,WAAW,EAAE,YAAY,EAAE;IAEjE,oCAAoC;IACpC,MAAM,aAAa,MAAM,OAAO,CAAC,eAC7B,YAAY,GAAG,CAAC,CAAA,IAAK,CAAC;YACpB,MAAM,OAAO,EAAE,IAAI;YACnB,QAAQ,EAAE,WAAW,IAAI;YACzB,UAAU;QACZ,CAAC,KACD,EAAE;IAEN,MAAM,iBACJ,WAAW,MAAM,GAAG,IAChB,KAAK,GAAG,IAAI,WAAW,GAAG,CAAC,CAAA,IAAK,EAAE,IAAI,KACtC;IAEN,sCAAsC;IACtC,MAAM,iBAAiB,MAAM,OAAO,CAAC,gBACjC,aACG,MAAM,CAAC,CAAA,IAAK,EAAE,IAAI,GAAG,gBAAgB,wBAAwB;KAC7D,GAAG,CAAC,CAAA,IAAK,CAAC;YACT,MAAM,OAAO,EAAE,IAAI;YACnB,QAAQ;YACR,UAAU,EAAE,KAAK,IAAI;QACvB,CAAC,KACH,EAAE;IAEN,MAAM,eAAe;WAChB;WACA;KACJ;IAED,MAAM,oBAAoB,gBAAgB,CAAC,EAAE,EAAE;IAE/C,qBACE,wPAAC;QAAI,WAAU;kBACb,cAAA,wPAAC,oMAAmB;YAAC,OAAM;YAAO,QAAQ;sBACxC,cAAA,wPAAC,4KAAS;gBACR,MAAM;gBACN,QAAQ;oBAAE,KAAK;oBAAI,OAAO;oBAAI,MAAM;gBAAI;;kCAExC,wPAAC,wLAAa;wBAAC,iBAAgB;;;;;;kCAG/B,wPAAC,wKAAK;wBACJ,SAAQ;wBACR,MAAK;wBACL,eAAe;wBACf,QAAQ;4BAAC;4BAAW;yBAAU;wBAC9B,MAAM;4BAAE,UAAU;wBAAG;;;;;;kCAGvB,wPAAC,wKAAK;wBACJ,eAAe,CAAC,IAAM,CAAC,CAAC,EAAE,CAAC,IAAI,SAAS,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;wBACvD,MAAM;4BAAE,UAAU;wBAAG;;;;;;kCAGvB,wPAAC,4KAAO;wBACN,gBAAgB,CAAC,IAAM,CAAC,KAAK,EAAE,GAAG;wBAClC,WAAW,CAAC,GAAG,OAAS;gCACtB,CAAC,CAAC,EAAE,OAAO,GAAG,cAAc,IAAI;gCAChC,SAAS,WAAW,kBAAkB;6BACvC;;;;;;kCAGH,wPAAC,0KAAM;wBAAC,eAAc;wBAAS,QAAQ;;;;;;oBAGtC,mCACC,wPAAC,wLAAa;wBACZ,GAAG;wBACH,QAAO;wBACP,iBAAgB;wBAChB,OAAO;4BACL,OAAO;4BACP,UAAU;4BACV,MAAM;4BACN,UAAU;wBACZ;;;;;;kCAKJ,wPAAC,sKAAI;wBACH,MAAK;wBACL,SAAQ;wBACR,MAAK;wBACL,QAAO;wBACP,aAAa;wBACb,KAAK;4BAAE,GAAG;wBAAE;wBACZ,mBAAmB;;;;;;kCAIrB,wPAAC,sKAAI;wBACH,MAAK;wBACL,SAAQ;wBACR,MAAK;wBACL,QAAO;wBACP,iBAAgB;wBAChB,aAAa;wBACb,KAAK;4BAAE,GAAG;wBAAE;wBACZ,mBAAmB;;;;;;;;;;;;;;;;;;;;;;AAM/B","debugId":null}},
    {"offset": {"line": 342, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/transactions/components/forecastSummary.jsx"],"sourcesContent":["\"use client\";\r\n\r\nexport default function ForecastSummary({ data }) {\r\n  if (!Array.isArray(data) || data.length === 0) {\r\n    return (\r\n      <p className=\"text-sm text-gray-500 text-center\">\r\n        Forecast not available yet.\r\n      </p>\r\n    );\r\n  }\r\n\r\n  const sorted = [...data]\r\n    .filter(d => typeof d.value === \"number\" && !isNaN(d.value))\r\n    .sort((a, b) => a.year - b.year);\r\n\r\n  if (sorted.length === 0) {\r\n    return (\r\n      <p className=\"text-sm text-gray-500 text-center\">\r\n        Forecast not available yet.\r\n      </p>\r\n    );\r\n  }\r\n\r\n  const nextYear = sorted[0];\r\n  const firstFive = sorted.slice(0, Math.min(5, sorted.length));\r\n\r\n  const avgForecast =\r\n    firstFive.reduce((sum, e) => sum + e.value, 0) / firstFive.length;\r\n\r\n  const growthRate =\r\n    firstFive.length > 1\r\n      ? ((firstFive[firstFive.length - 1].value - firstFive[0].value) /\r\n          firstFive[0].value) *\r\n        100\r\n      : 0;\r\n\r\n  const format = (v) =>\r\n    new Intl.NumberFormat(\"en-PH\", {\r\n      style: \"currency\",\r\n      currency: \"PHP\",\r\n    }).format(v);\r\n\r\n    \r\nreturn (\r\n<div className=\"grid grid-cols-1 gap-4 mt-2\">\r\n    <Card\r\n      title={`Next Year Forecast (${nextYear.year})`}\r\n      value={format(nextYear.value)}\r\n      color=\"indigo\"\r\n    />\r\n\r\n    <Card\r\n      title=\"Next 2â€“5 Year Avg\"\r\n      value={format(avgForecast)}\r\n      color=\"green\"\r\n    />\r\n\r\n    <Card\r\n      title=\"Growth Rate\"\r\n      value={`${growthRate.toFixed(2)}%`}\r\n      color=\"yellow\"\r\n    />\r\n  </div>\r\n);\r\n}\r\n\r\nfunction Card({ title, value, color }) {\r\n  const styles = {\r\n    indigo: \"bg-indigo-50 text-indigo-700\",\r\n    green: \"bg-green-50 text-green-700\",\r\n    yellow: \"bg-yellow-50 text-yellow-700\",\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`rounded-lg px-3 py-4 text-center flex flex-col justify-center items-center ${styles[color]}`}\r\n    >\r\n      <p className=\"text-[18px] font-medium text-gray-600 leading-tight\">\r\n        {title}\r\n      </p>\r\n      <p className=\"mt-2 text-base font-semibold\">\r\n        {value}\r\n      </p>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;AAEe,SAAS,gBAAgB,EAAE,IAAI,EAAE;IAC9C,IAAI,CAAC,MAAM,OAAO,CAAC,SAAS,KAAK,MAAM,KAAK,GAAG;QAC7C,qBACE,wPAAC;YAAE,WAAU;sBAAoC;;;;;;IAIrD;IAEA,MAAM,SAAS;WAAI;KAAK,CACrB,MAAM,CAAC,CAAA,IAAK,OAAO,EAAE,KAAK,KAAK,YAAY,CAAC,MAAM,EAAE,KAAK,GACzD,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,IAAI,GAAG,EAAE,IAAI;IAEjC,IAAI,OAAO,MAAM,KAAK,GAAG;QACvB,qBACE,wPAAC;YAAE,WAAU;sBAAoC;;;;;;IAIrD;IAEA,MAAM,WAAW,MAAM,CAAC,EAAE;IAC1B,MAAM,YAAY,OAAO,KAAK,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG,OAAO,MAAM;IAE3D,MAAM,cACJ,UAAU,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,KAAK,EAAE,KAAK,UAAU,MAAM;IAEnE,MAAM,aACJ,UAAU,MAAM,GAAG,IACf,AAAC,CAAC,SAAS,CAAC,UAAU,MAAM,GAAG,EAAE,CAAC,KAAK,GAAG,SAAS,CAAC,EAAE,CAAC,KAAK,IAC1D,SAAS,CAAC,EAAE,CAAC,KAAK,GACpB,MACA;IAEN,MAAM,SAAS,CAAC,IACd,IAAI,KAAK,YAAY,CAAC,SAAS;YAC7B,OAAO;YACP,UAAU;QACZ,GAAG,MAAM,CAAC;IAGd,qBACA,wPAAC;QAAI,WAAU;;0BACX,wPAAC;gBACC,OAAO,CAAC,oBAAoB,EAAE,SAAS,IAAI,CAAC,CAAC,CAAC;gBAC9C,OAAO,OAAO,SAAS,KAAK;gBAC5B,OAAM;;;;;;0BAGR,wPAAC;gBACC,OAAM;gBACN,OAAO,OAAO;gBACd,OAAM;;;;;;0BAGR,wPAAC;gBACC,OAAM;gBACN,OAAO,GAAG,WAAW,OAAO,CAAC,GAAG,CAAC,CAAC;gBAClC,OAAM;;;;;;;;;;;;AAIZ;AAEA,SAAS,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE;IACnC,MAAM,SAAS;QACb,QAAQ;QACR,OAAO;QACP,QAAQ;IACV;IAEA,qBACE,wPAAC;QACC,WAAW,CAAC,2EAA2E,EAAE,MAAM,CAAC,MAAM,EAAE;;0BAExG,wPAAC;gBAAE,WAAU;0BACV;;;;;;0BAEH,wPAAC;gBAAE,WAAU;0BACV;;;;;;;;;;;;AAIT","debugId":null}},
    {"offset": {"line": 454, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/transactions/page.jsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect, useMemo } from \"react\";\r\n\r\nimport { supabase } from \"../../../lib/supabaseClient\"\r\nimport {\r\n  AlertCircle,\r\n  BarChart3,\r\n  Wallet,\r\n  TrendingUp,\r\n  ArrowDown,\r\n  PiggyBank,\r\n} from \"lucide-react\"\r\n\r\n// Hooks\r\nimport useBudgetData from \"./lib/useBudgetData\"\r\nimport useBreakdownData from \"./lib/useBreakdownData\"\r\n\r\n// Components\r\nimport SummaryCards from \"./components/summaryCards\"\r\nimport ForecastChart from \"./components/forecastChart\"\r\nimport ForecastSummary from \"./components/forecastSummary\"\r\nexport default function TransactionPage() {\r\n  const [session, setSession] = useState(null)\r\n  const [forecastData, setForecastData] = useState([])\r\n  const [error, setError] = useState(null)\r\n\r\n  const { budgetData, loading, fetchBudgetData } = useBudgetData()\r\n  const { fetchBreakdownData } = useBreakdownData()\r\n\r\n  useEffect(() => {\r\n    if (budgetData.length > 0) loadForecast()\r\n  }, [budgetData])\r\n\r\n  async function loadForecast() {\r\n    try {\r\n      setError(null)\r\n      const res = await fetch(\"/api/forecast\", { cache: \"no-store\" })\r\n      if (!res.ok) throw new Error(\"Forecast failed\")\r\n      const data = await res.json()\r\n\r\n      const lastYear = Math.max(...budgetData.map(d => d.year))\r\n      setForecastData(\r\n        data.filter(d => d.year > lastYear).map(d => ({\r\n          year: d.year,\r\n          value: Number(d.yhat_upper),\r\n          lower: Number(d.yhat_lower),\r\n          upper: Number(d.yhat_upper),\r\n        }))\r\n      )\r\n    } catch {\r\n      setError(\"Failed to load forecast data.\")\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    supabase.auth.getSession().then(({ data: { session } }) => {\r\n      setSession(session)\r\n      if (session) {\r\n        fetchBudgetData()\r\n        fetchBreakdownData()\r\n      }\r\n    })\r\n  }, [])\r\n\r\n  const SUGGESTED_ALLOCATION_RATIOS = {\r\n  \"Personal Services\": 0.38,\r\n  \"MOOE\": 0.32,              // â¬† increased due to utilities (electricity, water)\r\n  \"20% BDF\": 0.20,\r\n  \"5% BDRRMF\": 0.05,\r\n  \"10% SK Fund\": 0.03,\r\n  \"15% GAD\": 0.02,\r\n};\r\n\r\n\r\nconst suggestedAllocationData = useMemo(() => {\r\n  if (!forecastData || forecastData.length === 0) return [];\r\n\r\n  const nextYearForecast =\r\n    forecastData.find(f => f.type === \"next_year\")?.amount;\r\n\r\n  if (!nextYearForecast) return [];\r\n\r\n  return Object.entries(SUGGESTED_ALLOCATION_RATIOS).map(\r\n    ([category, ratio]) => ({\r\n      name: category,\r\n      value: Number((nextYearForecast * ratio).toFixed(2)),\r\n    })\r\n  );\r\n}, [forecastData]);\r\n\r\n  /* ---------------- UI ---------------- */\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-slate-50 p-6 space-y-6\">\r\n\r\n      {/* CASH FLOW HEADER */}\r\n      <div className=\"bg-gradient-to-r from-emerald-800 to-emerald-600 rounded-xl px-6 py-4 flex justify-between items-center\">\r\n        <h1 className=\"text-white text-2xl font-semibold\">\r\n          Forecast\r\n\r\n        </h1>\r\n\r\n        \r\n      </div>\r\n\r\n      {/* ERROR */}\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3\">\r\n          <AlertCircle className=\"text-red-500\" />\r\n          <p className=\"text-sm text-red-700\">{error}</p>\r\n        </div>\r\n      )}\r\n\r\n  \r\n      {/* LOADING */}\r\n      {loading && (\r\n        <div className=\"bg-white rounded-xl p-10 text-center text-gray-500\">\r\n          Loading budget dataâ€¦\r\n        </div>\r\n      )}\r\n\r\n      {/* CHARTS SECTION */}\r\n      {forecastData.length > 0 && (\r\n<div className=\"grid grid-cols-1 lg:grid-cols-6 gap-6\">\r\n\r\n          {/* MAIN CHART */}\r\n<div className=\"lg:col-span-4 bg-white rounded-xl border shadow-sm\">\r\n            <div className=\"px-6 py-4 border-b flex items-center gap-2\">\r\n              <span className=\"h-8 w-2 bg-emerald-500 rounded-full\"></span>\r\n              <h2 className=\"font-semibold text-gray-800\">\r\n                Future Forecast\r\n              </h2>\r\n            </div>\r\n<div className=\"p-6 h-[440px]\">\r\n              <ForecastChart\r\n                historyData={budgetData}\r\n                forecastData={forecastData}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* SIDE SUMMARY */}\r\n<div className=\"lg:col-span-2 bg-white rounded-xl border shadow-sm\">\r\n            <div className=\"px-6 py-4 border-b\">\r\n              <h3 className=\"font-semibold text-gray-800\">\r\n                Forecast Summary\r\n              </h3>\r\n              <p className=\"text-sm text-gray-600\">\r\n                Future budget outlook\r\n              </p>\r\n            </div>\r\n            <div className=\"p-6\">\r\n              <ForecastSummary data={forecastData} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n     {/* =========================\r\n    FUTURE BUDGET RECOMMENDATIONS + PIE\r\n========================== */}\r\n<div className=\"bg-white rounded-xl border shadow-sm mt-6\">\r\n  <div className=\"px-6 py-4 border-b\">\r\n    <h2 className=\"text-lg font-semibold\">\r\n      ðŸ“Š Future Budget Recommendations\r\n    </h2>\r\n    <p className=\"text-sm text-gray-600\">\r\n      Data-driven recommendations based on forecast trends\r\n    </p>\r\n  </div>\r\n\r\n  {/* GRID */}\r\n  <div className=\"p-6 grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n\r\n\r\n{/* LEFT: TEXT RECOMMENDATIONS */}\r\n<div className=\"lg:col-span-2 space-y-4 text-sm\">\r\n  {[\r\n    {\r\n      text: \"Actual expenditure patterns indicate that electricity and water expenses under MOOE consistently consume a significant portion of operational funds. It is strongly recommended to increase the MOOE allocationâ€”particularly for electricity billsâ€”to avoid service disruptions.\",\r\n    },\r\n    {\r\n      text: \"Beyond utilities, MOOE supports essential operational needs such as office supplies, maintenance, training, and communication expenses. A gradual increase in MOOE will ensure uninterrupted barangay services.\",\r\n    },\r\n    {\r\n      text: \"Personal Services account for a large share of the total budget. Any increase should be carefully balanced to support honoraria and contractual staff while preserving funds for operations and development.\",\r\n    },\r\n    {\r\n      text: \"Regularly evaluate Barangay Development Fund (BDF) and Sangguniang Kabataan (SK) allocations to ensure projects deliver measurable community impact.\",\r\n    },\r\n  ].map((item, index) => (\r\n    <div\r\n      key={index}\r\n      className=\"flex gap-3 items-start p-4 border rounded-lg bg-emerald-50\"\r\n    >\r\n      <span className=\"text-emerald-600 mt-0.5\">âœ”</span>\r\n      <p className=\"text-gray-800\">{item.text}</p>\r\n    </div>\r\n  ))}\r\n</div>\r\n{/* RIGHT: SUGGESTED ALLOCATION PIE */}\r\n<div className=\"border rounded-xl p-4 flex flex-col items-center\">\r\n  <h3 className=\"text-sm font-semibold mb-2\">\r\n    ðŸ§  Suggested Allocation (Forecast-Based)\r\n  </h3>\r\n  <p className=\"text-xs text-gray-500 mb-4 text-center\">\r\n    Based on forecasted total budget and spending behavior\r\n  </p>\r\n\r\n  {/* PIE CHART COMPONENT */}\r\n  <ExpensePieChart transactions={forecastTransactions} />\r\n</div>\r\n  </div>\r\n</div>\r\n\r\n      {/* EMPTY STATE */}\r\n      {!loading && budgetData.length === 0 && (\r\n        <div className=\"bg-white rounded-xl border p-12 text-center\">\r\n          <div className=\"mx-auto h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center mb-4\">\r\n            <BarChart3 className=\"text-gray-400\" />\r\n          </div>\r\n          <h3 className=\"text-lg font-semibold text-gray-900\">\r\n            No Budget Data\r\n          </h3>\r\n          <p className=\"text-sm text-gray-600\">\r\n            Upload a budget file to get started\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\n/* ---------------- SMALL UI COMPONENTS ---------------- */\r\n\r\nfunction StatCard({ title, value, icon }) {\r\n  return (\r\n    <div className=\"bg-white rounded-xl border shadow-sm p-4 flex items-center gap-4\">\r\n      <div className=\"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center text-emerald-600\">\r\n        {icon}\r\n      </div>\r\n      <div>\r\n        <p className=\"text-xs text-gray-500\">{title}</p>\r\n        <p className=\"text-lg font-semibold\">{value}</p>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction Suggestion({ text }) {\r\n  return (\r\n    <div className=\"flex items-start gap-3 bg-emerald-50 border border-emerald-00 rounded-lg p-4\">\r\n      <span className=\"text-emerald-600 font-bold\">âœ”</span>\r\n      <p className=\"text-gray-700\">{text}</p>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}