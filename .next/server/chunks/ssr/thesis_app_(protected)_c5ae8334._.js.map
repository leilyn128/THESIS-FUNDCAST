{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/reports/components/PieChart.jsx"],"sourcesContent":["import { PieChart, Pie, Cell, Tooltip, ResponsiveContainer } from \"recharts\";\r\n\r\nconst PieChartComponent = ({ data }) => {\r\n  const COLORS = [\r\n    \"#1e40af\",\r\n    \"#059669\",\r\n    \"#dc2626\",\r\n    \"#d97706\",\r\n    \"#7c3aed\",\r\n    \"#be185d\",\r\n    \"#0284c7\",\r\n    \"#16a34a\",\r\n  ];\r\n\r\n  const CustomTooltip = ({ active, payload }) => {\r\n    if (active && payload && payload.length) {\r\n      const item = payload[0];\r\n      return (\r\n        <div className=\"bg-white border border-slate-200 rounded-lg shadow p-3\">\r\n          <p className=\"text-sm font-semibold text-slate-800\">\r\n            {item.payload.category}\r\n          </p>\r\n          <p className=\"text-sm text-slate-600\">\r\n            ‚Ç±{Number(item.value).toLocaleString(\"en-PH\")}\r\n          </p>\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white border border-slate-200 rounded-xl shadow-sm h-full flex flex-col\">\r\n\r\n      {/* HEADER */}\r\n      <div className=\"px-4 py-3 border-b border-slate-100 flex items-center gap-3\">\r\n        <div className=\"w-8 h-8 bg-emerald-600 rounded-lg flex items-center justify-center\">\r\n          <svg className=\"w-4 h-4 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n            <path d=\"M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z\" />\r\n            <path d=\"M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z\" />\r\n          </svg>\r\n        </div>\r\n        <h2 className=\"text-base font-bold text-slate-800\">\r\n          Budget Distribution\r\n        </h2>\r\n      </div>\r\n\r\n      {/* BODY */}\r\n      <div className=\"flex-1 flex flex-col px-4 py-3\">\r\n\r\n        {/* PIE */}\r\n        <div className=\"h-[300px]\">\r\n          {data?.length ? (\r\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n              <PieChart>\r\n                <Pie\r\n                  data={data}\r\n                  dataKey=\"amount\"\r\n                  nameKey=\"subcategory\"\r\n                  cx=\"50%\"\r\n                  cy=\"50%\"\r\n                  innerRadius={55}\r\n                  outerRadius={95}\r\n                  paddingAngle={2}\r\n                >\r\n                  {data.map((_, index) => (\r\n                    <Cell\r\n                      key={index}\r\n                      fill={COLORS[index % COLORS.length]}\r\n                    />\r\n                  ))}\r\n                </Pie>\r\n                <Tooltip content={<CustomTooltip />} />\r\n              </PieChart>\r\n            </ResponsiveContainer>\r\n          ) : (\r\n            <div className=\"h-full flex items-center justify-center text-sm text-slate-400\">\r\n              No data available\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* ‚úÖ MANUAL LEGEND (THIS FIXES IT) */}\r\n        <div className=\"mt-8 max-h-[160px] overflow-y-auto space-y-2 pr-3\">\r\n          {data?.map((item, index) => (\r\n            <div\r\n              key={index}\r\n              className=\"flex items-center gap- text-sm text-slate-700\"\r\n            >\r\n              <span\r\n                className=\"w-3 h-3 rounded-full\"\r\n                style={{ backgroundColor: COLORS[index % COLORS.length] }}\r\n              />\r\n              <span className=\"truncate\">\r\n                {item.subcategory}\r\n              </span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PieChartComponent;\r\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAEA,MAAM,oBAAoB,CAAC,EAAE,IAAI,EAAE;IACjC,MAAM,SAAS;QACb;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,MAAM,gBAAgB,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE;QACxC,IAAI,UAAU,WAAW,QAAQ,MAAM,EAAE;YACvC,MAAM,OAAO,OAAO,CAAC,EAAE;YACvB,qBACE,wPAAC;gBAAI,WAAU;;kCACb,wPAAC;wBAAE,WAAU;kCACV,KAAK,OAAO,CAAC,QAAQ;;;;;;kCAExB,wPAAC;wBAAE,WAAU;;4BAAyB;4BAClC,OAAO,KAAK,KAAK,EAAE,cAAc,CAAC;;;;;;;;;;;;;QAI5C;QACA,OAAO;IACT;IAEA,qBACE,wPAAC;QAAI,WAAU;;0BAGb,wPAAC;gBAAI,WAAU;;kCACb,wPAAC;wBAAI,WAAU;kCACb,cAAA,wPAAC;4BAAI,WAAU;4BAAqB,MAAK;4BAAe,SAAQ;;8CAC9D,wPAAC;oCAAK,GAAE;;;;;;8CACR,wPAAC;oCAAK,GAAE;;;;;;;;;;;;;;;;;kCAGZ,wPAAC;wBAAG,WAAU;kCAAqC;;;;;;;;;;;;0BAMrD,wPAAC;gBAAI,WAAU;;kCAGb,wPAAC;wBAAI,WAAU;kCACZ,MAAM,uBACL,wPAAC,oMAAmB;4BAAC,OAAM;4BAAO,QAAO;sCACvC,cAAA,wPAAC,0KAAQ;;kDACP,wPAAC,gKAAG;wCACF,MAAM;wCACN,SAAQ;wCACR,SAAQ;wCACR,IAAG;wCACH,IAAG;wCACH,aAAa;wCACb,aAAa;wCACb,cAAc;kDAEb,KAAK,GAAG,CAAC,CAAC,GAAG,sBACZ,wPAAC,sKAAI;gDAEH,MAAM,MAAM,CAAC,QAAQ,OAAO,MAAM,CAAC;+CAD9B;;;;;;;;;;kDAKX,wPAAC,4KAAO;wCAAC,uBAAS,wPAAC;;;;;;;;;;;;;;;;;;;;qFAIvB,wPAAC;4BAAI,WAAU;sCAAiE;;;;;;;;;;;kCAOpF,wPAAC;wBAAI,WAAU;kCACZ,MAAM,IAAI,CAAC,MAAM,sBAChB,wPAAC;gCAEC,WAAU;;kDAEV,wPAAC;wCACC,WAAU;wCACV,OAAO;4CAAE,iBAAiB,MAAM,CAAC,QAAQ,OAAO,MAAM,CAAC;wCAAC;;;;;;kDAE1D,wPAAC;wCAAK,WAAU;kDACb,KAAK,WAAW;;;;;;;+BARd;;;;;;;;;;;;;;;;;;;;;;AAiBnB;uCAEe","debugId":null}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/dashboard/components/expensePieChart.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport {\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\n\r\nconst expenseCOLORS = [\r\n  \"#ef4444\", \"#f97316\", \"#eab308\", \"#84cc16\", \"#22c55e\",\r\n  \"#0ea5e9\", \"#6366f1\", \"#a855f7\", \"#ec4899\", \"#14b8a6\"\r\n];\r\n\r\n// --- COA-COMPLIANT EXPENSE CATEGORIZER ---\r\nexport function categorizeExpense(description = \"\") {\r\n  const t = description.toLowerCase();\r\n\r\n  if (\r\n    t.includes(\"hon.\") ||\r\n    t.includes(\"honor\") ||\r\n    t.includes(\"appointed\") ||\r\n    t.includes(\"elected\") ||\r\n    t.includes(\"tanod\") ||\r\n    t.includes(\"bhw\") ||\r\n    t.includes(\"chief\")\r\n  ) return \"PS (Personal Services)\";\r\n\r\n  if (t.includes(\"sk\")) return \"10% SK Fund\";\r\n\r\n  if (\r\n    t.includes(\"fire\") ||\r\n    t.includes(\"safety drill\") ||\r\n    t.includes(\"disaster\") ||\r\n    t.includes(\"rescue\") ||\r\n    t.includes(\"drrm\")\r\n  ) return \"5% BDRRM Fund\";\r\n\r\n  if (\r\n    t.includes(\"women\") ||\r\n    t.includes(\"senior\") ||\r\n    t.includes(\"pwd\") ||\r\n    t.includes(\"nutrition\") ||\r\n    t.includes(\"feeding\") ||\r\n    t.includes(\"deworm\") ||\r\n    t.includes(\"gap\")\r\n  ) return \"GAD Programs\";\r\n\r\n  if (\r\n    t.includes(\"construction\") ||\r\n    t.includes(\"improvement\") ||\r\n    t.includes(\"materials\") ||\r\n    t.includes(\"solar\") ||\r\n    t.includes(\"equipment\") ||\r\n    t.includes(\"road\") ||\r\n    t.includes(\"building\") ||\r\n    t.includes(\"water system\") ||\r\n    t.includes(\"rehab\")\r\n  ) return \"20% BDF / Capital Outlay\";\r\n\r\n  if (\r\n    t.includes(\"travel\") ||\r\n    t.includes(\"seminar\") ||\r\n    t.includes(\"training\") ||\r\n    t.includes(\"supplies\") ||\r\n    t.includes(\"office\") ||\r\n    t.includes(\"water\") ||\r\n    t.includes(\"electric\") ||\r\n    t.includes(\"bond\") ||\r\n    t.includes(\"security\") ||\r\n    t.includes(\"bookkeeper\") ||\r\n    t.includes(\"lumber\") ||\r\n    t.includes(\"fuel\") ||\r\n    t.includes(\"diesel\") ||\r\n    t.includes(\"registration\") ||\r\n    t.includes(\"check book\") ||\r\n    t.includes(\"maintenance\") ||\r\n    t.includes(\"interest\") ||\r\n    t.includes(\"tax\") ||\r\n    t.includes(\"pcf\")\r\n  ) return \"MOOE\";\r\n\r\n  return \"Other / Non-Office\";\r\n}\r\n\r\nexport default function ExpensePieChart({ transactions }) {\r\n  const expenseTx = transactions.filter(t => t.withdrawal > 0);\r\n\r\n  // =========================\r\n  // GROUP EXPENSES\r\n  // =========================\r\n  const grouped = {};\r\n  expenseTx.forEach(t => {\r\n    const category = categorizeExpense(t.description || \"\");\r\n    grouped[category] = (grouped[category] || 0) + Number(t.withdrawal);\r\n  });\r\n\r\n  // =========================\r\n  // BUILD STABLE CHART DATA\r\n  // =========================\r\n  const chartData = Object.entries(grouped).map(\r\n    ([name, value]) => ({ name, value })\r\n  );\r\n\r\n  // =========================\r\n  // STABLE COLOR MAP (KEY FIX)\r\n  // =========================\r\n  const colorMap = {};\r\n  chartData.forEach((item, index) => {\r\n    colorMap[item.name] =\r\n      expenseCOLORS[index % expenseCOLORS.length];\r\n  });\r\n\r\n  return (\r\n<div className=\"w-full flex flex-col items-center gap-8\">\r\n      {/* PIE */}\r\n      <div className=\"w-[260px]\">\r\n        <ResponsiveContainer width=\"100%\" aspect={1}>\r\n          <PieChart>\r\n            <Pie\r\n              data={chartData}\r\n              cx=\"50%\"\r\n              cy=\"50%\"\r\n              outerRadius=\"80%\"\r\n              dataKey=\"value\"\r\n              label={false}\r\n              labelLine={false}\r\n            >\r\n              {chartData.map((item) => (\r\n                <Cell\r\n                  key={item.name}\r\n                  fill={colorMap[item.name]}\r\n                />\r\n              ))}\r\n            </Pie>\r\n\r\n            <Tooltip />\r\n          </PieChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n\r\n     {/* CUSTOM LEGEND */}\r\n<div className=\"mt-4 w-full max-w-xs space-y-2 flex flex-col items-start text-left\">\r\n  {chartData.map((item) => (\r\n    <div\r\n      key={item.name}\r\n      className=\"flex items-center gap-2 text-m\"\r\n    >\r\n      <span\r\n        className=\"w-3 h-3 rounded-sm\"\r\n        style={{ backgroundColor: colorMap[item.name] }}\r\n      />\r\n      <span className=\"text-gray-700\">\r\n        {item.name}\r\n      </span>\r\n    </div>\r\n  ))}\r\n</div>\r\n\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 387, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/reports/page.jsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { supabase } from \"../../../lib/supabaseClient\";\r\nimport PieChartComponent from \"./components/PieChart\";\r\nimport { useSearchParams } from \"next/navigation\";\r\nimport { categorizeExpense } from \"../dashboard/components/expensePieChart\";\r\n\r\nexport default function ReportsPage() {\r\n  const [breakdown, setBreakdown] = useState([]);\r\n  const [years, setYears] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n\r\n  // üîë HISTORY PAGE FILTERS\r\n  const [filterYear, setFilterYear] = useState(\"all\");\r\n  const [selectedCategory, setSelectedCategory] = useState(\"all\");\r\n\r\nconst searchParams = useSearchParams();\r\n\r\nconst dashboardYear = (() => {\r\n  const y = Number(searchParams.get(\"year\"));\r\n  return Number.isFinite(y) ? y : new Date().getFullYear();\r\n})();\r\n\r\nconst fetchBreakdown = async () => {\r\n  setLoading(true);\r\n  setMessage(\"\");\r\n\r\n  let historyData = [];\r\n  let uploadData = [];\r\n\r\n  try {\r\n    /* =========================\r\n       1Ô∏è‚É£ HISTORY (‚â§ dashboardYear - 1)\r\n    ========================= */\r\n    const historyEndYear = dashboardYear - 1;\r\n\r\n    const { data: history, error: historyError } = await supabase\r\n      .from(\"barangay_budget_breakdown\")\r\n      .select(\"*\")\r\n      .gte(\"year\", 2015)\r\n      .lte(\"year\", historyEndYear);\r\n\r\n    if (historyError) throw historyError;\r\n\r\n historyData = history.map(row => ({\r\n  year: row.year,\r\n  category: row.category,\r\n  subcategory:\r\n    row.category === \"Expenses\"\r\n      ? categorizeExpense(row.description)\r\n      : row.subcategory || row.category,\r\n  description: row.description,\r\n  amount: Number(row.amount || 0),\r\n  source: \"history\",\r\n}));\r\n\r\n\r\n/* =========================\r\n   3Ô∏è‚É£ ACTUAL EXPENSES (FROM TRANSACTIONS)\r\n========================= */\r\n/* =========================\r\n   3Ô∏è‚É£ ACTUAL EXPENSES (FROM TRANSACTIONS)\r\n========================= */\r\nconst { data: tx, error: txError } = await supabase\r\n  .from(\"transactions\")\r\n  .select(\"date, description, withdrawal\");\r\n\r\nif (txError) throw txError;\r\n\r\nconst transactionExpenses = tx\r\n  .filter(t => t.withdrawal && t.withdrawal > 0)\r\n  .map(t => ({\r\n    year: new Date(t.date).getFullYear(),\r\n    category: \"Expenses\",\r\n    subcategory: categorizeExpense(t.description || \"\"),\r\n    description: t.description || \"Expense\",\r\n    amount: Number(t.withdrawal),\r\n    source: \"transactions\",\r\n  }));\r\n\r\n\r\n    /* =========================\r\n       2Ô∏è‚É£ UPLOADS (‚â• dashboardYear)\r\n       ALWAYS APPROPRIATIONS\r\n    ========================= */\r\n    const { data: uploads, error: uploadsError } = await supabase\r\n      .from(\"budget_uploads\")\r\n      .select(\"*\")\r\n.gte(\"year\", dashboardYear - 1)\r\n\r\n    if (uploadsError) throw uploadsError;\r\n\r\n    uploadData = uploads.map(row => ({\r\n      year: row.year,\r\n      category: \"Appropriations\",\r\n      subcategory: row.category,\r\n      description: row.description,\r\n      amount: Number(row.amount || 0),\r\n      source: \"uploads\",\r\n    }));\r\n\r\n    /* =========================\r\n       3Ô∏è‚É£ MERGE & AGGREGATE\r\n    ========================= */\r\nconst merged = [...historyData, ...uploadData, ...transactionExpenses];\r\n\r\n    const aggregated = Object.values(\r\n      merged.reduce((acc, row) => {\r\nconst key = `${row.year}|${row.category}|${row.subcategory}|${row.description}`;\r\n        if (!acc[key]) acc[key] = { ...row, _key: key };\r\n        else acc[key].amount += row.amount;\r\n        return acc;\r\n      }, {})\r\n    );\r\n\r\n    setBreakdown(aggregated);\r\n\r\n \r\nconst yearList = [];\r\n\r\nfor (let y = dashboardYear - 1; y >= 2015; y--) {\r\n  yearList.push(y);\r\n}\r\n\r\nsetYears(yearList);\r\n;\r\n\r\n  } catch (err) {\r\n    console.error(err);\r\n    setMessage(\"Failed to load budget data.\");\r\n  }\r\n\r\n  setLoading(false);\r\n};\r\nuseEffect(() => {\r\n  if (!dashboardYear) return;\r\n  fetchBreakdown();\r\n}, [dashboardYear]);\r\n\r\nconst filteredData = breakdown.filter(row => {\r\n  // üîë YEAR FILTER\r\n  const matchYear =\r\n    filterYear === \"all\"\r\n      ? true\r\n      : row.year === Number(filterYear);\r\n\r\n  // üîë CATEGORY FILTER\r\n  const matchCategory =\r\n    selectedCategory === \"all\" || row.category === selectedCategory;\r\n\r\n  return matchYear && matchCategory;\r\n});\r\n\r\n  /* =========================\r\n     PIE CHART DATA\r\n  ========================= */\r\n  const pieChartData = filteredData.reduce((acc, row) => {\r\n    const found = acc.find(i => i.subcategory === row.subcategory);\r\n    if (found) found.amount += row.amount;\r\n    else acc.push({ subcategory: row.subcategory, amount: row.amount });\r\n    return acc;\r\n  }, []);\r\n\r\n  const totalAmount = pieChartData.reduce((s, i) => s + i.amount, 0);\r\n\r\n  const pieChartWithPercentage = pieChartData.map(i => ({\r\n    ...i,\r\n    percentage: totalAmount ? (i.amount / totalAmount) * 100 : 0,\r\n  }));\r\n\r\n  const groupedByYear = filteredData.reduce((acc, row) => {\r\n  if (!acc[row.year]) acc[row.year] = [];\r\n  acc[row.year].push(row);\r\n  return acc;\r\n}, {});\r\n\r\nconst displayTotal = filteredData.reduce(\r\n  (sum, row) => sum + row.amount,\r\n  0\r\n);\r\nconst totalLabel =\r\n  selectedCategory === \"Income\"\r\n    ? \"Total Income\"\r\n    : selectedCategory === \"Appropriations\"\r\n    ? \"Total Appropriations\"\r\n    : selectedCategory === \"Expenses\"\r\n    ? \"Total Expenses\"\r\n    : \"Total Budget Allocation\";\r\n\r\n\r\n  /* =========================\r\n     RENDER\r\n  ========================= */\r\n return (\r\n  <div className=\"w-full h-screen overflow-hidden flex flex-col space-y-4\">\r\n\r\n    {/* PAGE HEADER */}\r\n    <div className=\"rounded-2xl bg-gradient-to-r from-emerald-900 via-emerald-800 to-emerald-700 px-6 py-5\">\r\n      <h1 className=\"text-2xl text-white font-semibold\">üìä History</h1>\r\n    </div>\r\n\r\n    {/* MAIN CONTENT */}\r\n    <section className=\"grid grid-cols-1 xl:grid-cols-4 gap-6 flex-1 overflow-hidden\">\r\n\r\n      {/* LEFT PANEL */}\r\n      <div className=\"xl:col-span-3 bg-white p-6 rounded-lg shadow flex flex-col overflow-hidden\">\r\n\r\n        {/* TABLE HEADER */}\r\n        <div className=\"mb-4\">\r\n          <h2 className=\"text-lg font-bold text-gray-800\">\r\n            üèõ Barangay Budget Breakdown\r\n          </h2>\r\n          \r\n        </div>\r\n\r\n       {/* FILTER BAR */}\r\n<div className=\"flex flex-wrap items-center gap-6 mb-4\">\r\n\r\n  {/* YEAR FILTER */}\r\n  <div className=\"flex items-center gap-2\">\r\n    <span className=\"text-sm font-semibold text-gray-700\">\r\n      Year:\r\n    </span>\r\n    <select\r\n      value={filterYear}\r\n      onChange={e => setFilterYear(e.target.value)}\r\n      className=\"px-4 py-2 border rounded-full text-sm font-medium\r\n                 focus:ring-2 focus:ring-emerald-500 focus:outline-none\"\r\n    >\r\n      <option value=\"all\">All</option>\r\n      {years.map(y => (\r\n        <option key={y} value={y}>{y}</option>\r\n      ))}\r\n    </select>\r\n  </div>\r\n\r\n  {/* CATEGORY FILTER */}\r\n  <div className=\"flex items-center gap-2\">\r\n    <span className=\"text-sm font-semibold text-gray-700\">\r\n      Category:\r\n    </span>\r\n    <select\r\n      value={selectedCategory}\r\n      onChange={e => setSelectedCategory(e.target.value)}\r\n      className=\"px-4 py-2 border rounded-full text-sm font-medium\r\n                 focus:ring-2 focus:ring-emerald-500 focus:outline-none\"\r\n    >\r\n      <option value=\"all\">All</option>\r\n      <option value=\"Income\">Income</option>\r\n      <option value=\"Appropriations\">Appropriations</option>\r\n      <option value=\"Expenses\">Expenses</option>\r\n    </select>\r\n  </div>\r\n\r\n</div>\r\n\r\n        {/* TABLE (SCROLLABLE ONLY) */}\r\n<div className=\"border rounded-lg max-h-[800px] overflow-hidden\">\r\n          {loading ? (\r\n            <p className=\"p-4\">Loading‚Ä¶</p>\r\n          ) : filteredData.length === 0 ? (\r\n            <p className=\"p-4 italic text-gray-500\">No data available.</p>\r\n          ) : (\r\n            <div className=\"h-full overflow-y-auto\">\r\n              <table className=\"w-full border-collapse text-sm font-mono tracking-wide\">\r\n                <thead className=\"bg-gray-100 sticky top-0 z-10\">\r\n                  <tr>\r\n                    <th className=\"border px-4 py-2 text-left\">Subcategory</th>\r\n                    <th className=\"border px-4 py-2 text-left\">Description</th>\r\n                    <th className=\"border px-4 py-2 text-right\">Amount (‚Ç±)</th>\r\n                  </tr>\r\n                </thead>\r\n\r\n                <tbody>\r\n                  {filteredData.map(row => (\r\n                    <tr key={row._key} className=\"hover:bg-gray-50\">\r\n                      <td className=\"border px-4 py-2\">{row.subcategory}</td>\r\n                      <td className=\"border px-4 py-2\">{row.description}</td>\r\n                      <td className=\"border px-4 py-2 text-right\">\r\n                        ‚Ç±{row.amount.toLocaleString(\"en-PH\", {\r\n                          minimumFractionDigits: 2,\r\n                        })}\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n\r\n                <tfoot className=\"bg-slate-100 border-t-2 border-slate-400\">\r\n                  <tr>\r\n                    <td\r\n                      colSpan={2}\r\n                      className=\"px-6 py-4 text-right text-sm font-bold text-slate-800 uppercase\"\r\n                    >\r\n                      {totalLabel}\r\n                    </td>\r\n                    <td className=\"px-6 py-4 text-right font-bold text-green-700\">\r\n                      ‚Ç±{displayTotal.toLocaleString(\"en-PH\", {\r\n                        minimumFractionDigits: 2,\r\n                        maximumFractionDigits: 2,\r\n                      })}\r\n                    </td>\r\n                  </tr>\r\n                </tfoot>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n  <div className=\"xl:col-span-1 flex flex-col items-center justify-start\">\r\n  <div className=\"w-full max-w-[420px] h-[600px]\">\r\n    <PieChartComponent data={pieChartWithPercentage} />\r\n  </div>\r\n</div>\r\n\r\n    </section>\r\n  </div>\r\n);\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}