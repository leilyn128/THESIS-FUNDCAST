{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/dashboard/components/useCashflowData.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { supabase } from \"../../../../lib/supabaseClient\";\r\n\r\nexport function useCashflowData(year) {\r\n  const [transactions, setTransactions] = useState([]);\r\n  const [chartData, setChartData] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (year) fetchCashflow();\r\n  }, [year]);\r\n\r\n  const fetchCashflow = async () => {\r\n    setLoading(true);\r\n\r\n    const startDate = `${year}-01-01`;\r\n    const endDate = `${year}-12-31`;\r\n\r\n    // 1Ô∏è‚É£ Fetch transactions FOR SELECTED YEAR ONLY\r\n    const { data, error } = await supabase\r\n      .from(\"transactions\")\r\n      .select(\"*\")\r\n      .gte(\"date\", startDate)\r\n      .lte(\"date\", endDate)\r\n      .order(\"date\", { ascending: true });\r\n\r\n    if (error) {\r\n      console.error(\"‚ùå Supabase fetch error:\", error.message);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // 2Ô∏è‚É£ Clean numeric values\r\n    const mapped = (data || [])\r\n      .filter((row) => row.date)\r\n      .map((row) => ({\r\n        ...row,\r\n        deposit: Number(String(row.deposit || \"0\").replace(/[‚Ç±, ]/g, \"\")),\r\n        withdrawal: Number(String(row.withdrawal || \"0\").replace(/[‚Ç±, ]/g, \"\")),\r\n        balance: Number(String(row.balance || \"0\").replace(/[‚Ç±, ]/g, \"\")),\r\n\r\n        // OPTIONAL: normalize categories (safe)\r\n        incomeCategory: row.income_category || row.category || null,\r\n        expenseCategory: row.expense_category || row.category || null,\r\n      }));\r\n\r\n    setTransactions(mapped);\r\n\r\n    // 3Ô∏è‚É£ Aggregate per month\r\n    const grouped = {};\r\n\r\n    mapped.forEach((t) => {\r\n      const d = new Date(t.date);\r\n      const monthKey = d.toLocaleString(\"default\", {\r\n        month: \"short\",\r\n        year: \"numeric\",\r\n      });\r\n\r\n      if (!grouped[monthKey]) {\r\n        grouped[monthKey] = {\r\n          month: monthKey,\r\n          income: 0,\r\n          expense: 0,\r\n          balance: 0,\r\n        };\r\n      }\r\n\r\n      grouped[monthKey].income += t.deposit || 0;\r\n      grouped[monthKey].expense += t.withdrawal || 0;\r\n\r\n      // last balance of the month\r\n      grouped[monthKey].balance = t.balance || grouped[monthKey].balance;\r\n    });\r\n\r\n    const monthlyArray = Object.values(grouped)\r\n      .sort((a, b) => new Date(a.month) - new Date(b.month))\r\n      .map((g) => ({\r\n        ...g,\r\n        net: g.income - g.expense,\r\n      }));\r\n\r\n    setChartData(monthlyArray);\r\n    setLoading(false);\r\n  };\r\n\r\n  return {\r\n    transactions,\r\n    chartData,\r\n    loading,\r\n    refetch: fetchCashflow,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKO,SAAS,gBAAgB,IAAI;IAClC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,2NAAQ,EAAC,EAAE;IACnD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,2NAAQ,EAAC,EAAE;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,2NAAQ,EAAC;IAEvC,IAAA,4NAAS,EAAC;QACR,IAAI,MAAM;IACZ,GAAG;QAAC;KAAK;IAET,MAAM,gBAAgB;QACpB,WAAW;QAEX,MAAM,YAAY,GAAG,KAAK,MAAM,CAAC;QACjC,MAAM,UAAU,GAAG,KAAK,MAAM,CAAC;QAE/B,gDAAgD;QAChD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,2IAAQ,CACnC,IAAI,CAAC,gBACL,MAAM,CAAC,KACP,GAAG,CAAC,QAAQ,WACZ,GAAG,CAAC,QAAQ,SACZ,KAAK,CAAC,QAAQ;YAAE,WAAW;QAAK;QAEnC,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,2BAA2B,MAAM,OAAO;YACtD,WAAW;YACX;QACF;QAEA,2BAA2B;QAC3B,MAAM,SAAS,CAAC,QAAQ,EAAE,EACvB,MAAM,CAAC,CAAC,MAAQ,IAAI,IAAI,EACxB,GAAG,CAAC,CAAC,MAAQ,CAAC;gBACb,GAAG,GAAG;gBACN,SAAS,OAAO,OAAO,IAAI,OAAO,IAAI,KAAK,OAAO,CAAC,UAAU;gBAC7D,YAAY,OAAO,OAAO,IAAI,UAAU,IAAI,KAAK,OAAO,CAAC,UAAU;gBACnE,SAAS,OAAO,OAAO,IAAI,OAAO,IAAI,KAAK,OAAO,CAAC,UAAU;gBAE7D,wCAAwC;gBACxC,gBAAgB,IAAI,eAAe,IAAI,IAAI,QAAQ,IAAI;gBACvD,iBAAiB,IAAI,gBAAgB,IAAI,IAAI,QAAQ,IAAI;YAC3D,CAAC;QAEH,gBAAgB;QAEhB,0BAA0B;QAC1B,MAAM,UAAU,CAAC;QAEjB,OAAO,OAAO,CAAC,CAAC;YACd,MAAM,IAAI,IAAI,KAAK,EAAE,IAAI;YACzB,MAAM,WAAW,EAAE,cAAc,CAAC,WAAW;gBAC3C,OAAO;gBACP,MAAM;YACR;YAEA,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;gBACtB,OAAO,CAAC,SAAS,GAAG;oBAClB,OAAO;oBACP,QAAQ;oBACR,SAAS;oBACT,SAAS;gBACX;YACF;YAEA,OAAO,CAAC,SAAS,CAAC,MAAM,IAAI,EAAE,OAAO,IAAI;YACzC,OAAO,CAAC,SAAS,CAAC,OAAO,IAAI,EAAE,UAAU,IAAI;YAE7C,4BAA4B;YAC5B,OAAO,CAAC,SAAS,CAAC,OAAO,GAAG,EAAE,OAAO,IAAI,OAAO,CAAC,SAAS,CAAC,OAAO;QACpE;QAEA,MAAM,eAAe,OAAO,MAAM,CAAC,SAChC,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,KAAK,IAAI,IAAI,KAAK,EAAE,KAAK,GACnD,GAAG,CAAC,CAAC,IAAM,CAAC;gBACX,GAAG,CAAC;gBACJ,KAAK,EAAE,MAAM,GAAG,EAAE,OAAO;YAC3B,CAAC;QAEH,aAAa;QACb,WAAW;IACb;IAEA,OAAO;QACL;QACA;QACA;QACA,SAAS;IACX;AACF","debugId":null}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/dashboard/components/expensePieChart.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport {\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\n\r\nconst expenseCOLORS = [\r\n  \"#ef4444\", \"#f97316\", \"#eab308\", \"#84cc16\", \"#22c55e\",\r\n  \"#0ea5e9\", \"#6366f1\", \"#a855f7\", \"#ec4899\", \"#14b8a6\"\r\n];\r\n\r\n// --- COA-COMPLIANT EXPENSE CATEGORIZER ---\r\nexport function categorizeExpense(description = \"\") {\r\n  const t = description.toLowerCase();\r\n\r\n  if (\r\n    t.includes(\"hon.\") ||\r\n    t.includes(\"honor\") ||\r\n    t.includes(\"appointed\") ||\r\n    t.includes(\"elected\") ||\r\n    t.includes(\"tanod\") ||\r\n    t.includes(\"bhw\") ||\r\n    t.includes(\"chief\")\r\n  ) return \"PS (Personal Services)\";\r\n\r\n  if (t.includes(\"sk\")) return \"10% SK Fund\";\r\n\r\n  if (\r\n    t.includes(\"fire\") ||\r\n    t.includes(\"safety drill\") ||\r\n    t.includes(\"disaster\") ||\r\n    t.includes(\"rescue\") ||\r\n    t.includes(\"drrm\")\r\n  ) return \"5% BDRRM Fund\";\r\n\r\n  if (\r\n    t.includes(\"women\") ||\r\n    t.includes(\"senior\") ||\r\n    t.includes(\"pwd\") ||\r\n    t.includes(\"nutrition\") ||\r\n    t.includes(\"feeding\") ||\r\n    t.includes(\"deworm\") ||\r\n    t.includes(\"gap\")\r\n  ) return \"GAD Programs\";\r\n\r\n  if (\r\n    t.includes(\"construction\") ||\r\n    t.includes(\"improvement\") ||\r\n    t.includes(\"materials\") ||\r\n    t.includes(\"solar\") ||\r\n    t.includes(\"equipment\") ||\r\n    t.includes(\"road\") ||\r\n    t.includes(\"building\") ||\r\n    t.includes(\"water system\") ||\r\n    t.includes(\"rehab\")\r\n  ) return \"20% BDF / Capital Outlay\";\r\n\r\n  if (\r\n    t.includes(\"travel\") ||\r\n    t.includes(\"seminar\") ||\r\n    t.includes(\"training\") ||\r\n    t.includes(\"supplies\") ||\r\n    t.includes(\"office\") ||\r\n    t.includes(\"water\") ||\r\n    t.includes(\"electric\") ||\r\n    t.includes(\"bond\") ||\r\n    t.includes(\"security\") ||\r\n    t.includes(\"bookkeeper\") ||\r\n    t.includes(\"lumber\") ||\r\n    t.includes(\"fuel\") ||\r\n    t.includes(\"diesel\") ||\r\n    t.includes(\"registration\") ||\r\n    t.includes(\"check book\") ||\r\n    t.includes(\"maintenance\") ||\r\n    t.includes(\"interest\") ||\r\n    t.includes(\"tax\") ||\r\n    t.includes(\"pcf\")\r\n  ) return \"MOOE\";\r\n\r\n  return \"Other / Non-Office\";\r\n}\r\n\r\nexport default function ExpensePieChart({ transactions }) {\r\n  const expenseTx = transactions.filter(t => t.withdrawal > 0);\r\n\r\n  // =========================\r\n  // GROUP EXPENSES\r\n  // =========================\r\n  const grouped = {};\r\n  expenseTx.forEach(t => {\r\n    const category = categorizeExpense(t.description || \"\");\r\n    grouped[category] = (grouped[category] || 0) + Number(t.withdrawal);\r\n  });\r\n\r\n  // =========================\r\n  // BUILD STABLE CHART DATA\r\n  // =========================\r\n  const chartData = Object.entries(grouped).map(\r\n    ([name, value]) => ({ name, value })\r\n  );\r\n\r\n  // =========================\r\n  // STABLE COLOR MAP (KEY FIX)\r\n  // =========================\r\n  const colorMap = {};\r\n  chartData.forEach((item, index) => {\r\n    colorMap[item.name] =\r\n      expenseCOLORS[index % expenseCOLORS.length];\r\n  });\r\n\r\n  return (\r\n<div className=\"w-full flex flex-col items-center gap-8\">\r\n      {/* PIE */}\r\n      <div className=\"w-[260px]\">\r\n        <ResponsiveContainer width=\"100%\" aspect={1}>\r\n          <PieChart>\r\n            <Pie\r\n              data={chartData}\r\n              cx=\"50%\"\r\n              cy=\"50%\"\r\n              outerRadius=\"80%\"\r\n              dataKey=\"value\"\r\n              label={false}\r\n              labelLine={false}\r\n            >\r\n              {chartData.map((item) => (\r\n                <Cell\r\n                  key={item.name}\r\n                  fill={colorMap[item.name]}\r\n                />\r\n              ))}\r\n            </Pie>\r\n\r\n            <Tooltip />\r\n          </PieChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n\r\n     {/* CUSTOM LEGEND */}\r\n<div className=\"mt-4 w-full max-w-xs space-y-2 flex flex-col items-start text-left\">\r\n  {chartData.map((item) => (\r\n    <div\r\n      key={item.name}\r\n      className=\"flex items-center gap-2 text-m\"\r\n    >\r\n      <span\r\n        className=\"w-3 h-3 rounded-sm\"\r\n        style={{ backgroundColor: colorMap[item.name] }}\r\n      />\r\n      <span className=\"text-gray-700\">\r\n        {item.name}\r\n      </span>\r\n    </div>\r\n  ))}\r\n</div>\r\n\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/expenses/components/budgetUpload.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect} from \"react\";\r\n\r\nimport { forwardRef, useImperativeHandle, useRef, useState } from \"react\";\r\nimport * as XLSX from \"xlsx\";\r\nimport { supabase } from \"../../../../lib/supabaseClient\";\r\n\r\nconst BudgetUploadPage = forwardRef(function BudgetUploadPage(\r\n  { mode = \"form\", selectedYear, onSuccess }, // üëà ADD onSuccess\r\n  ref\r\n) {\r\n\r\n  const fileInputRef = useRef(null);\r\n\r\n  const [category, setCategory] = useState(\"\");\r\n  const [description, setDescription] = useState(\"\");\r\n  const [amount, setAmount] = useState(\"\");\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    openFilePicker() {\r\n      fileInputRef.current?.click();\r\n    },\r\n  }));\r\nconst [previousCategories, setPreviousCategories] = useState([]);\r\nconst [previousDescriptions, setPreviousDescriptions] = useState([]);\r\n\r\nuseEffect(() => {\r\n  const loadCategories = async () => {\r\n    const { data, error } = await supabase\r\n      .from(\"budget_uploads\")\r\n      .select(\"category\")\r\n      .eq(\"year\", 2025);\r\n\r\n    if (!error && data) {\r\n      const unique = [...new Set(data.map(d => d.category))];\r\n      setPreviousCategories(unique);\r\n    }\r\n  };\r\n\r\n  loadCategories();\r\n}, []);\r\nuseEffect(() => {\r\n  if (!category || category === \"__new__\") {\r\n    setPreviousDescriptions([]);\r\n    return;\r\n  }\r\n\r\n  const loadDescriptions = async () => {\r\n    const { data, error } = await supabase\r\n      .from(\"budget_uploads\")\r\n      .select(\"description\")\r\n      .eq(\"year\", 2025)\r\n      .eq(\"category\", category);\r\n\r\n    if (!error && data) {\r\n      const unique = [...new Set(data.map(d => d.description))];\r\n      setPreviousDescriptions(unique);\r\n    }\r\n  };\r\n\r\n  loadDescriptions();\r\n}, [category]);\r\n\r\n  /* ================= FILE UPLOAD ================= */\r\n  const handleFile = async (file) => {\r\n    if (!file) return;\r\n\r\n    try {\r\n      let records = [];\r\n\r\n      if (file.name.endsWith(\".csv\")) {\r\n        const text = await file.text();\r\n        const rows = text.trim().split(/\\r?\\n/).slice(1);\r\n        records = rows.map((row) => {\r\n          const r = row.split(\",\");\r\n          return {\r\n            year: Number(r[0]),\r\n            category: r[1],\r\n            description: r[2],\r\n            amount: Number(r[3]),\r\n          };\r\n        });\r\n      }\r\n\r\n      if (file.name.endsWith(\".xlsx\")) {\r\n        const buffer = await file.arrayBuffer();\r\n        const wb = XLSX.read(buffer, { type: \"array\" });\r\n        const sheet = wb.Sheets[wb.SheetNames[0]];\r\n        const json = XLSX.utils.sheet_to_json(sheet, { defval: \"\" });\r\n\r\n        records = json.map((row) => ({\r\n  year: selectedYear, // ‚úÖ FORCE DASHBOARD YEAR\r\n  category: row.category,\r\n  description: row.description,\r\n  amount: Number(row.amount),\r\n}));\r\n\r\n      }\r\n\r\n      await supabase\r\n        .from(\"budget_uploads\")\r\n        .upsert(records, { onConflict: \"year,category,description\" });\r\nonSuccess?.(); \r\n      alert(`‚úÖ Uploaded ${records.length} rows`);\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"‚ùå Upload failed\");\r\n    }\r\n  };\r\nconst handleManualSubmit = async () => {\r\n  if (!category || !description || !amount) {\r\n    alert(\"‚ùå Please complete all fields.\");\r\n    return;\r\n  }\r\n\r\n  const record = {\r\n    year: selectedYear, // ‚úÖ FROM DASHBOARD\r\n    category,\r\n    description,\r\n    amount: Number(amount),\r\n  };\r\n\r\n  const { error } = await supabase\r\n    .from(\"budget_uploads\")\r\n    .upsert(record, {\r\n      onConflict: \"year,category,description\",\r\n    });\r\n\r\n  if (error) {\r\n    console.error(error);\r\n    alert(\"‚ùå Failed to save record\");\r\n    return;\r\n  }\r\n\r\n  alert(\"‚úÖ Budget item saved\");\r\n  setDescription(\"\");\r\n  setAmount(\"\");\r\n};\r\n\r\n  return (\r\n    <>\r\n      {/* ALWAYS RENDER FILE INPUT (INVISIBLE) */}\r\n      <input\r\n        ref={fileInputRef}\r\n        type=\"file\"\r\n        accept=\".csv,.xlsx\"\r\n        className=\"hidden\"\r\n        onChange={(e) => handleFile(e.target.files?.[0])}\r\n      />\r\n\r\n {mode === \"form\" && (\r\n  <div className=\"space-y-4\">\r\n\r\n    {/* CATEGORY */}\r\n    <div>\r\n      <label className=\"text-xs font-medium text-slate-600\">Category</label>\r\n      <select\r\n        value={category}\r\n        onChange={(e) => setCategory(e.target.value)}\r\n        className=\"border rounded px-3 py-2 text-sm w-full\"\r\n      >\r\n        <option value=\"\">Select Category</option>\r\n\r\n        {previousCategories.map((c) => (\r\n          <option key={c} value={c}>{c}</option>\r\n        ))}\r\n\r\n        <option value=\"__new__\">‚ûï Add new category</option>\r\n      </select>\r\n\r\n      {category === \"__new__\" && (\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Enter new category\"\r\n          onChange={(e) => setCategory(e.target.value)}\r\n          className=\"border rounded px-3 py-2 text-sm w-full mt-1\"\r\n        />\r\n      )}\r\n    </div>\r\n\r\n    {/* DESCRIPTION */}\r\n    <div>\r\n      <label className=\"text-xs font-medium text-slate-600\">Description</label>\r\n\r\n      {previousDescriptions.length > 0 && (\r\n        <select\r\n          value={description}\r\n          onChange={(e) => setDescription(e.target.value)}\r\n          className=\"border rounded px-3 py-2 text-sm w-full\"\r\n        >\r\n          <option value=\"\">Select Description</option>\r\n\r\n          {previousDescriptions.map((d) => (\r\n            <option key={d} value={d}>{d}</option>\r\n          ))}\r\n\r\n          <option value=\"__new__\">‚ûï Add new description</option>\r\n        </select>\r\n      )}\r\n\r\n      {(description === \"__new__\" || previousDescriptions.length === 0) && (\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Enter description\"\r\n          onChange={(e) => setDescription(e.target.value)}\r\n          className=\"border rounded px-3 py-2 text-sm w-full mt-1\"\r\n        />\r\n      )}\r\n    </div>\r\n\r\n    {/* AMOUNT */}\r\n    <div>\r\n      <label className=\"text-xs font-medium text-slate-600\">Amount</label>\r\n      <input\r\n        type=\"number\"\r\n        value={amount}\r\n        onChange={(e) => setAmount(e.target.value)}\r\n        placeholder=\"Amount\"\r\n        className=\"border rounded px-3 py-2 text-sm w-full\"\r\n      />\r\n    </div>\r\n\r\n    <div className=\"flex justify-end\">\r\n      <button\r\n        onClick={handleManualSubmit}\r\n        className=\"bg-emerald-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-emerald-700\"\r\n      >\r\n        üíæ Save Budget Item\r\n      </button>\r\n    </div>\r\n\r\n  </div>\r\n)}\r\n\r\n    </>\r\n  );\r\n});\r\n\r\nexport default BudgetUploadPage;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 559, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ALDEGS09/thesis/app/%28protected%29/expenses/page.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n  Legend,\r\n} from \"recharts\";\r\n\r\nimport { useState, useEffect, useMemo , useRef } from \"react\";\r\nimport { useSearchParams } from \"next/navigation\";\r\nimport { supabase } from \"../../../lib/supabaseClient\";\r\nimport { useCashflowData } from \"../dashboard/components/useCashflowData\";\r\nimport { categorizeExpense } from \"../dashboard/components/expensePieChart\";\r\nimport BudgetUploadPage from \"../expenses/components/budgetUpload\";\r\n\r\n/* =========================\r\n   HELPERS\r\n========================= */\r\nfunction normalizeCategory(cat = \"\") {\r\n  const t = cat.toLowerCase();\r\n\r\n  if (t.includes(\"personal\")) return \"Personal Services\";\r\n  if (t.includes(\"mooe\")) return \"MOOE\";\r\n  if (t.includes(\"20\")) return \"20% BDF\";\r\n  if (t.includes(\"bdf\")) return \"20% BDF\";\r\n  if (t.includes(\"gadr\") || t.includes(\"gad\")) return \"15% GAD\";\r\n  if (t.includes(\"bdr\")) return \"5% BDRRMF\";\r\n  if (t.includes(\"sk\")) return \"10% SK Fund\";\r\n  if (t.includes(\"senior\")) return \"1% Senior & PWD\";\r\n\r\n  return null; // ‚ùó VERY IMPORTANT\r\n}\r\n\r\n\r\nexport default function ExpensesPage() {\r\n  /* =========================\r\n     YEAR\r\n  ========================= */\r\n  const [showUpload, setShowUpload] = useState(false);\r\n\r\n  const searchParams = useSearchParams();\r\n  const START_YEAR = 2025;\r\n  const currentYear = new Date().getFullYear();\r\n  const yearFromUrl = Number(searchParams.get(\"year\"));\r\n\r\n  const selectedYear =\r\n    yearFromUrl && yearFromUrl >= START_YEAR\r\n      ? yearFromUrl\r\n      : currentYear;\r\n\r\n  const uploadRef = useRef(null);\r\nconst [showUploadModal, setShowUploadModal] = useState(false);\r\nconst [showModal, setShowModal] = useState(false);\r\n\r\nconst refreshAllocations = async () => {\r\n  const { data, error } = await supabase\r\n    .from(\"budget_uploads\")\r\n    .select(\"id, category, amount, description\")\r\n    .eq(\"year\", selectedYear);\r\n\r\n  if (error) {\r\n    console.error(\"Refresh error:\", error);\r\n    return;\r\n  }\r\n\r\n  const totals = data.filter(\r\n    (r) => r.description?.trim().toLowerCase() === \"total\"\r\n  );\r\n\r\n  setAllocations(\r\n    totals.map((r) => ({\r\n      id: r.id,\r\n      category: normalizeCategory(r.category),\r\n      allocated: Number(r.amount),\r\n    }))\r\n  );\r\n};\r\n\r\n  /* =========================\r\n     TRANSACTIONS\r\n  ========================= */\r\n  const { transactions: fetchedTransactions } =\r\n    useCashflowData(selectedYear);\r\n\r\n  const [transactions, setTransactions] = useState([]);\r\n\r\n  useEffect(() => {\r\n  refreshAllocations();\r\n}, [selectedYear]);\r\n\r\n  /* =========================\r\n     ALLOCATION TOTALS\r\n  ========================= */\r\n  const [allocations, setAllocations] = useState([]);\r\n\r\n  useEffect(() => {\r\n    async function fetchAllocations() {\r\n      const { data, error } = await supabase\r\n        .from(\"budget_uploads\")\r\n        .select(\"id, category, amount, description\")\r\n        .eq(\"year\", selectedYear);\r\n\r\n      if (error) {\r\n        console.error(\"Allocation fetch error:\", error);\r\n        return;\r\n      }\r\n\r\n      const totals = (data || []).filter(\r\n        (row) =>\r\n          row.description?.trim().toLowerCase() === \"total\"\r\n      );\r\n\r\n      setAllocations(\r\n        totals.map((row) => ({\r\n          id: row.id,\r\n          category: normalizeCategory(row.category),\r\n          allocated: Number(row.amount),\r\n        }))\r\n      );\r\n    }\r\n\r\n    fetchAllocations();\r\n  }, [selectedYear]);\r\n  \r\n\r\n  /* =========================\r\n     BREAKDOWN STATE\r\n  ========================= */\r\n  const [expandedCategory, setExpandedCategory] = useState(null);\r\n  const [subcategories, setSubcategories] = useState({});\r\n\r\n  async function fetchSubcategories(category) {\r\n    const { data, error } = await supabase\r\n      .from(\"budget_uploads\")\r\n      .select(\"id, description, amount\")\r\n      .eq(\"year\", selectedYear)\r\n      .eq(\"category\", category)\r\n      .neq(\"description\", \"Total\");\r\n\r\n    if (error) {\r\n      console.error(\"Subcategory fetch error:\", error);\r\n      return;\r\n    }\r\n\r\n    setSubcategories((prev) => ({\r\n      ...prev,\r\n      [category]: data || [],\r\n    }));\r\n  }\r\n\r\n  function toggleCategory(category) {\r\n    setExpandedCategory((prev) => {\r\n      const next = prev === category ? null : category;\r\n\r\n      if (next && !subcategories[category]) {\r\n        fetchSubcategories(category);\r\n      }\r\n\r\n      return next;\r\n    });\r\n  }\r\n\r\n  /* =========================\r\n     CHART DATA (SOURCE = ALLOCATIONS)\r\n  ========================= */\r\n  const chartData = useMemo(() => {\r\n  const map = {};\r\n\r\n  // 1Ô∏è‚É£ Allocations = source of truth\r\n  allocations.forEach((a) => {\r\n    map[a.category] = {\r\n      category: a.category,\r\n      allocated: a.allocated,\r\n      spent: 0,\r\n    };\r\n  });\r\n\r\n  // 2Ô∏è‚É£ Apply expenses using SAME vocabulary\r\n  transactions.forEach((t) => {\r\n    if (!t.withdrawal || t.withdrawal <= 0) return;\r\n\r\n    const raw = categorizeExpense(t.description || \"\");\r\n    const category = normalizeCategory(raw);\r\n\r\n    if (!category) return;\r\n    if (!map[category]) return;\r\n\r\n    map[category].spent += Number(t.withdrawal);\r\n  });\r\n\r\n  return Object.values(map).sort(\r\n    (a, b) => b.allocated - a.allocated\r\n  );\r\n}, [allocations, transactions]);\r\n\r\n  /* =========================budget\r\n     UI\r\n  ========================= */\r\n\r\n return (\r\n  <div className=\"space-y-6\">\r\n\r\n    {/* ================= HEADER ================= */}\r\n    <div className=\"flex items-center justify-between rounded-xl bg-emerald-700 px-6 py-4 text-white shadow\">\r\n      <div>\r\n        <h1 className=\"text-xl font-semibold\">\r\n          üí∏ Expenses vs Budget Allocation\r\n        </h1>\r\n        <p className=\"text-xs opacity-90 mt-0.5\">\r\n          Official budget allocation with detailed breakdown\r\n        </p>\r\n      </div>\r\n\r\n      {/* RIGHT ACTIONS */}\r\n      <div className=\"flex gap-2\">\r\n        <button\r\n  type=\"button\"\r\n  onClick={() => setShowUploadModal(true)}\r\n  className=\"bg-white text-emerald-700 hover:bg-emerald-100 px-4 py-2 rounded-lg font-semibold shadow\"\r\n>\r\n  üì§ Upload File\r\n</button>\r\n        {showUploadModal && (\r\n  <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40\">\r\n    <div className=\"bg-white rounded-xl shadow-xl w-full max-w-md p-6 relative\">\r\n\r\n      {/* CLOSE */}\r\n      <button\r\n        onClick={() => setShowUploadModal(false)}\r\n        className=\"absolute top-3 right-3 text-slate-500 hover:text-slate-700\"\r\n      >\r\n        ‚úï\r\n      </button>\r\n\r\n      <h2 className=\"text-lg font-semibold mb-2\">\r\n        üì§ Upload Budget File\r\n      </h2>\r\n\r\n      <p className=\"text-sm text-slate-500 mb-4\">\r\n        Select a CSV or Excel (.xlsx) file to upload budget allocations.\r\n      </p>\r\n\r\n      {/* FILE PICKER UI */}\r\n      <div className=\"border-2 border-dashed border-emerald-300 rounded-lg p-6 text-center\">\r\n        <button\r\n          onClick={() => uploadRef.current?.openFilePicker()}\r\n          className=\"bg-emerald-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-emerald-700\"\r\n        >\r\n          üìÅ Choose File\r\n        </button>\r\n\r\n        <p className=\"text-xs text-slate-400 mt-2\">\r\n          Accepted formats: .csv, .xlsx\r\n        </p>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n)}\r\n\r\n\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setShowModal(true)}\r\n          className=\"bg-emerald-500 hover:bg-emerald-600 px-4 py-2 rounded-lg font-semibold shadow\"\r\n        >\r\n          ‚ûï Add Budget\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    {/* ================= MODAL ================= */}\r\n    {showModal && (\r\n      <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40\">\r\n        <div className=\"bg-white rounded-xl shadow-xl w-full max-w-3xl p-6 relative\">\r\n\r\n          {/* CLOSE */}\r\n          <button\r\n            onClick={() => setShowModal(false)}\r\n            className=\"absolute top-3 right-3 text-slate-500 hover:text-slate-700\"\r\n          >\r\n            ‚úï\r\n          </button>\r\n\r\n          <h2 className=\"text-lg font-semibold mb-4\">\r\n            ‚ûï Manual Budget Entry\r\n          </h2>\r\n\r\n\r\n<BudgetUploadPage\r\n  mode=\"form\"\r\n  selectedYear={selectedYear}\r\n  onSuccess={refreshAllocations}\r\n/>\r\n\r\n<BudgetUploadPage\r\n  ref={uploadRef}\r\n  mode=\"picker\"\r\n  selectedYear={selectedYear}\r\n  onSuccess={refreshAllocations}\r\n/>\r\n\r\n\r\n        </div>\r\n      </div>\r\n    )}\r\n\r\n    {/* ================= INVISIBLE FILE UPLOADER ================= */}\r\n<BudgetUploadPage ref={uploadRef} mode=\"picker\" selectedYear={selectedYear} />\r\n\r\n    {/* ================= BUDGET CARDS ================= */}\r\n    <div className=\"bg-white p-5 rounded-xl border shadow-sm\">\r\n      <h3 className=\"font-semibold text-base mb-4\">\r\n        üìä Budget Allocation\r\n      </h3>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        {allocations.map((a) => {\r\n          const isOpen = expandedCategory === a.category;\r\n\r\n          return (\r\n            <div\r\n              key={a.id}\r\n              className={`rounded-lg border transition\r\n                ${isOpen ? \"border-emerald-400\" : \"border-gray-200\"}\r\n              `}\r\n            >\r\n              <div className=\"px-4 py-3 flex justify-between\">\r\n                <div>\r\n                  <p className=\"text-[18px] uppercase\">\r\n                    {a.category || \"Uncategorized\"}\r\n                  </p>\r\n\r\n                  <p className=\"text-xl font-semibold text-emerald-600\">\r\n                    ‚Ç±{a.allocated.toLocaleString()}\r\n                  </p>\r\n                </div>\r\n\r\n                <button\r\n                  className=\"text-[11px] text-emerald-600\"\r\n                  onClick={() => toggleCategory(a.category)}\r\n                >\r\n                  {isOpen ? \"Hide\" : \"Details\"}\r\n                </button>\r\n              </div>\r\n\r\n              {isOpen && (\r\n                <div className=\"border-t px-4 py-2 bg-gray-50 text-xs space-y-1 max-h-56 overflow-y-auto\">\r\n                  {subcategories[a.category]?.length ? (\r\n                    subcategories[a.category].map((s) => (\r\n                      <div key={s.id} className=\"flex justify-between\">\r\n                        <span className=\"truncate max-w-[70%]\">\r\n                          {s.description}\r\n                        </span>\r\n                        <span className=\"font-medium\">\r\n                          ‚Ç±{Number(s.amount).toLocaleString()}\r\n                        </span>\r\n                      </div>\r\n                    ))\r\n                  ) : (\r\n                    <p className=\"italic text-gray-400\">\r\n                      No breakdown available\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n\r\n    {/* ================= CHART ================= */}\r\n    <div className=\"bg-white p-6 rounded-xl border shadow-sm\">\r\n      <h3 className=\"font-semibold text-lg mb-4\">\r\n        üìà Allocation vs Expenses\r\n      </h3>\r\n\r\n      <ResponsiveContainer width=\"100%\" height={320}>\r\n        <BarChart data={chartData}>\r\n          <XAxis dataKey=\"category\" />\r\n          <YAxis />\r\n          <Tooltip formatter={(v) => `‚Ç±${v.toLocaleString()}`} />\r\n          <Legend />\r\n          <Bar dataKey=\"allocated\" fill=\"#10b981\" />\r\n          <Bar dataKey=\"spent\" fill=\"#ef4444\" />\r\n        </BarChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n\r\n  </div>\r\n);\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}